---
title: "The power of Bicycles to Fight Climate Change"
subtitle: "SDS 192: MP5"
author: 
- name: Sethatevy Bong
  affiliation: Smith College
- name: Esa Schenck
  affiliation: Smith College
-name: Veronica Kessler  
date: "`r format(Sys.Date(), '%B %e, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    fig_width: 7
    fig_height: 6
    fig_caption: true
    code_folding: show
    df_print: paged
editor_options: 
  chunk_output_type: inline
references:
- id: xie2016bookdown
  type: book
  title: "Bookdown: Authoring books and technical documents with R markdown"
  author: 
  - family: Xie
    given: Yihui
  issued:
    year: 2016
  publisher: CRC Press
  url: https://bookdown.org/yihui/rmarkdown/
---


```{r setup, include=FALSE}
library(tidyverse)
library(sds192)
library(RMySQL)
library(leaflet)
library(sf)
db <- dbConnect(
  MySQL(), 
  host = "scidb.smith.edu", 
  user = "sds192", 
  password = "DSismfc@S", 
  dbname = "airlines"
)
knitr::opts_chunk$set(
  message = FALSE,
  echo = TRUE, 
  connection = db, 
  max.print = 20
)
```


## Introduction

Have you wondered about the power of bicycles to fight climate change? 
 Last spring when a friend of mine at Smith told me that she wanted a car so she could have more independence, I immediately screamed inside myself thinking in the tons of carbon dioxide that that car would deliver to the environment in its lifespan.  I told her that she should wait to have a lot of money and buy an electric car instead or get a bicycle in the meantime. She laughed and seemed to agree. Our decisions today have a long and imperceptible effect especially when we talk about global warming and climate change.

 According to [NASA](https://climate.nasa.gov/causes/) there are several gases in the atmosphere trapping heat. One of those gases is carbon dioxide (CO2). This gas is released into the atmosphere through various natural processes and mostly, activities caused only by humans.  Deforestation and burning of fossil fuels are the primary drivers of carbon emissions. We have increased the levels of CO2 by 47% since the industrial revolution.

 Last year, in October, [Smith College divested from fossil fuels](https://www.smith.edu/president-kathleen-mccartney/letters/2019-20/fossil-fuels-and-smith-endowment ). The college voted to exclude Smith College’s endowment from any future investment with such industry. . This was a major victory for students who pressured for such change and for the community in general. It is a step we are convinced other colleges and universities will follow as well.

Last year we also got acquainted with the eloquence and determination of a 17 year old Swiss red hair girl. I remember her clearly for her bold statement: “How dare you? You have stolen my dreams and my childhood with your empty words” ![](https://www.youtube.com/watch?v=TMrtLsQbaok) Greta Thunberg, an student and environmental activist, became the youngest and most outspoken critic of the lack of global policies to fight climate change. Perhaps the most heroic act we might remember about Ms. Thunberg is her decision to sail instead of flying from Europe to the United States to attend the 2019 UN Climate Action Summit. 

What does all of that has to do with the citylike system in New York City and the data presented in this project? 
According to a Greenhouse Gas emission report for NYC in 2016, 30% of the city emissions came from the transportation system. Cars are the largest generators of emission with 96% footprint. Cars powered with gasoline composed 80% of the transportation base emissions. See figures 1 and 2. [^1]

##Figure 1.

![](https://github.com/sds192-f20/mp5-charlie-b/blob/9e0d79cfdd602837d10a6dcb5e8b6e46129e2c82/NYC%20ANNUAL%20EMISSIONS%20BY%20SOURCE.png?raw=true)
##Figure 2. 
![](https://github.com/sds192-f20/mp5-charlie-b/blob/9e0d79cfdd602837d10a6dcb5e8b6e46129e2c82/NYC%20EMISSIONS%20BY%20SECTOR.png?raw=true)

In this perspective, we could follow the example of the Netherlands, Denmark, the United Kingdom  and Germany that have incentivized the use of bicycles and discourage the use of cars by imposing heavy taxes on gasoline. Bikes can be used to reduce carbon emissions and mitigate climate change. Promoting the use of bicycles is essential to mitigate the effect of climate change and local government must facilitate adequate financial support.

#Our data:

Note : The data that we used was [citibikenyc](https://www.citibikenyc.com/system-data).  Trips made by staff members in their labor activities was removed as well as any trips lower than 60 second as they were false starts.



This article is about arguing whether age and gender are drivers for use the citibike system in New YorK and weather this could be a rationale tied to climate change perceptions. We also seek to expose the areas of higher confluence in the city for the use of these bikes.


[^github]: Please see [our GitHub repository](https://github.com/sds192-s20/mp3-group-*) for complete code. 

## Exploratory data analysis

```{sql, connection=db, output.var = "Trips_during_school_year"}
SELECT duration, birth_year, gender, start_station_id FROM citibike.trips
WHERE duration > 600
AND user_type = 'subscriber'
AND stop_time < '2017-06-01#' OR start_time > '2017-09-01#';
```


# We want to group those users younger than 30 and older than 30 to know which group uses the bike system more frequently

```{sql connection=db, output.var = "Trips"}
SELECT duration, birth_year, gender
 FROM citibike.trips
WHERE duration > 600
AND user_type = 'subscriber';

```

```{r}
Trips_Age <- Trips %>% 
  mutate(age_category = ifelse(birth_year >= 1987, "Thirthy or Younger", "Older Than Thirty"))
```


## In our first graph we plotted it the total trips people of each age group took in 2017. We found that  older than 30-year old people use the systems more than 30-year old or younger. With people aged 25 and 32 being the group using the bike system more 25 thousand trips a year

```{r}
Trips_Age %>% 
  group_by(birth_year, age_category) %>% 
   summarize(total = sum(n())/10000) %>%
  ggplot(aes(x = birth_year, y = total, fill= age_category)) + 
  geom_col()+
  scale_fill_manual(values = c("blue", "lightblue"))+
  xlim(c(1957, 2005))+
   labs (title = " Use of the Citibike System According to Age in 2017")+
  labs(y= "Total Trips in Tens of Thousands", x= "Birth Year")+
  labs(fill= "Age Category")+
  theme(plot.title = element_text(colour = "black", hjust = 0.5, face = "bold"))
 
```


### In our second graph we wanted to find out which gender is more likely to use the bike system in New York City. We found that men are more incline than women to ride the public bikes.

```{r}
Trips %>% 
  group_by(birth_year, gender) %>% 
  filter(birth_year >= 1957, gender != 0) %>%
  mutate(gender = ifelse(gender == 1, "Male", "Female")) %>% 
  summarize(total = sum(n())) %>%
  ggplot(aes(x = birth_year, y = total, fill = gender)) + 
  geom_col()+
   scale_fill_manual(values =c("Pink", "lightblue"))+
  labs(title = "Gender Usage of the Bike System in 2017")+
  theme(plot.title = element_text(colour = "black", hjust = 0.4, face = "bold"))+
  labs(x= "Birth Year", y = "Total duration Trips?")+
    labs(fill = "Gender")
  
```

Please see the [SQL chapter of the `bookdown` book](
https://rmarkdown.rstudio.com/authoring_knitr_engines.html%23sql#sql) for more information. 

You can cite references using parentheses or not. @xie2016bookdown wrote about this. See also [@xie2016bookdown].




```{sql connection=db, output.var = "Trips"}
SELECT duration, birth_year, gender
 FROM citibike.trips
WHERE duration > 600
AND user_type = 'subscriber';

```


# Station Data

```{sql connection=db, output.var = "months_station"}
SELECT station_id, name, num_starts, num_stops, avg_lat, avg_lon
 FROM citibike.station_months 
```

What stations get the most average rides (both starts and stops)?
Average numbers of trips per month:

```{r}
months_station_2 <- months_station %>% 
  #select(-station_id) %>% 
  mutate(trips = num_starts + num_stops) %>% 
  group_by(name) %>% 
  summarize(total_months = sum(n()),
            total_starts = sum(num_starts), 
          avg_trips = total_starts/total_months,
          avg_lat = first(avg_lat),
          avg_lon = first(avg_lon)
         )
```



# Station Data


```{r}
 Top_50_Stations <- months_station_2 %>%
 head(50) 
station_pal <- colorNumeric(
  palette = "Red", 
  domain = Top_50_Stations %>%
    pull(avg_trips) %>%
    range())

leaflet(Top_50_Stations) %>% 
  addTiles() %>%
  addCircles(lng = ~avg_lon, lat = ~avg_lat, weight = 3,
    radius = ~sqrt(avg_trips)*3,
    color = ~station_pal(avg_trips), popup = paste("<b>",Top_50_Stations$name, "</b>", "<br>",
                           "Average Number of Bicycles Used:", Top_50_Stations$avg_trips), opacity = 100)
```






## Analysis

What did you discover? 

## Conclusion

What did you *learn* about the data set your explored?  

[^1]: [Inventory of New York City Greenhouse Gas Emissions in 2016](https://www1.nyc.gov/assets/sustainability/downloads/pdf/publications/GHG%20Inventory%20Report%20Emission%20Year%202016.pdf)

---

## Word count

```{r word_count, message=FALSE, echo=FALSE}
sds192::text_stats()
```


## Standards

In this assignment, we are attempting the following standards:

```{r buttons, echo=FALSE}
standard_button("markdown")
standard_button("aesthetics")
standard_button("wrangling")
standard_button("context")
standard_button("reshape")
standard_button("relational")
standard_button("ethics")
standard_button("github")
standard_button("iteration")
standard_button("function")
standard_button("spatial")
standard_button("leaflet")
standard_button("query")
```

## References

